# CWatcher - Linux 系統監控平台產品需求文檔 (PRD)

## 1. 專案背景與目的

### 1.1 商業與技術痛點

**主要痛點：**
- **多伺服器管理複雜性**：企業環境中通常需要同時監控多台 Linux 伺服器，缺乏統一的監控介面
- **即時性監控需求**：系統管理員需要即時了解伺服器的 CPU、記憶體、磁碟、網路等關鍵指標
- **故障預警不足**：缺乏有效的預警機制，往往在系統出現嚴重問題後才發現
- **歷史數據分析困難**：缺乏直觀的圖表工具來分析系統性能趨勢
- **遠端監控需求**：需要透過 Web 介面遠端監控伺服器狀態，不受地理位置限制

**解決方案價值：**
- 提供統一的 Web 監控平台，支援多伺服器集中管理
- 即時顯示系統關鍵指標，提升運維效率
- 提供視覺化圖表，便於趨勢分析和問題診斷
- 降低系統維護成本，提高系統可用性

### 1.2 目標用戶群體

**主要用戶：**
- **系統管理員**：負責日常伺服器維護和監控
- **DevOps 工程師**：需要監控開發、測試、生產環境
- **IT 運維團隊**：企業級環境的集中監控需求
- **中小企業 IT 負責人**：資源有限但需要專業監控工具

**次要用戶：**
- **開發人員**：需要了解應用程式對系統資源的影響
- **技術主管**：需要系統性能報告和趨勢分析

## 2. 功能需求

### 2.1 核心功能列表

#### 2.1.1 伺服器連接與管理 (P0 - 最高優先級)
- **多伺服器支援**：支援同時監控多台 Linux 伺服器
- **SSH 連接**：透過 SSH 協議安全連接到目標伺服器
- **連接狀態管理**：即時顯示伺服器在線/離線/警告狀態
- **伺服器分組**：支援按環境、功能等維度對伺服器進行分組

**操作流程：**
1. 用戶輸入伺服器 IP、用戶名、密碼、SSH 端口
2. 系統驗證連接並建立 SSH 會話
3. 成功連接後將伺服器加入監控列表
4. 支援保存連接憑證（加密存儲）

#### 2.1.2 系統指標監控 (P0 - 最高優先級)

**CPU 監控：**
- 即時 CPU 使用率百分比
- CPU 核心數和頻率資訊
- CPU 使用率歷史趨勢圖表
- 平均值和峰值統計

**記憶體監控：**
- 記憶體使用率和可用記憶體
- 已用/快取/空閒記憶體詳細資訊
- 記憶體使用趨勢圖表
- 記憶體類型和總容量資訊

**磁碟監控：**
- 磁碟使用率和剩餘空間
- 磁碟 I/O 讀寫速度
- 磁碟類型和檔案系統資訊
- 磁碟 I/O 歷史趨勢圖表

**網路監控：**
- 即時上傳/下載速度
- 網路流量歷史趨勢
- 累計流量統計
- 網路介面狀態

#### 2.1.3 視覺化圖表系統 (P0 - 最高優先級)
- **即時圓形進度圖**：顯示 CPU、記憶體、磁碟使用率
- **時間序列折線圖**：顯示各項指標的歷史趨勢
- **多時間範圍選擇**：1小時、6小時、24小時視圖
- **互動式圖表**：支援縮放、懸停顯示詳細數值

#### 2.1.4 系統資訊展示 (P1 - 高優先級)
- **硬體資訊**：主機名、CPU 型號、記憶體規格
- **作業系統資訊**：OS 版本、核心版本、系統運行時間
- **負載資訊**：系統負載平均值
- **存儲資訊**：磁碟類型、檔案系統、分區資訊

#### 2.1.5 用戶介面與體驗 (P1 - 高優先級)
- **響應式設計**：支援桌面和行動裝置
- **暗色主題**：適合長時間監控使用
- **伺服器搜尋**：快速定位目標伺服器
- **狀態指示器**：清晰的視覺狀態提示

### 2.2 進階功能 (P2 - 中等優先級)

#### 2.2.1 警報與通知系統
- **閾值設定**：自定義 CPU、記憶體、磁碟使用率警報閾值
- **多種通知方式**：郵件、Slack、Webhook 通知
- **警報歷史記錄**：查看歷史警報事件
- **警報等級分類**：資訊、警告、嚴重等級

#### 2.2.2 數據存儲與分析
- **歷史數據存儲**：支援長期數據保存
- **數據匯出功能**：CSV、JSON 格式匯出
- **性能報告生成**：週報、月報自動生成
- **趨勢分析**：智能分析系統性能趨勢

#### 2.2.3 用戶管理與權限
- **多用戶支援**：支援多個用戶同時使用
- **角色權限管理**：管理員、操作員、只讀用戶
- **操作日誌記錄**：記錄用戶操作歷史
- **單點登錄集成**：支援 LDAP、OAuth 等認證方式

### 2.3 功能優先級排序

**P0 (最高優先級) - MVP 核心功能：**
1. SSH 連接與伺服器管理
2. 四大核心指標監控 (CPU/記憶體/磁碟/網路)
3. 即時數據展示和基礎圖表
4. 基本的 Web UI 介面

**P1 (高優先級) - 增強用戶體驗：**
1. 系統詳細資訊展示
2. 多時間範圍圖表
3. 響應式設計優化
4. 伺服器狀態管理

**P2 (中等優先級) - 企業級功能：**
1. 警報通知系統
2. 歷史數據分析
3. 用戶權限管理
4. 數據匯出功能

## 3. 技術需求

### 3.1 推薦技術棧

#### 3.1.1 前端技術
- **框架**：React 18
- **UI 框架**：Tailwind CSS (已在原型中使用)
- **圖表庫**：Chart.js (已在原型中使用) 或 ECharts
- **狀態管理**：Redux Toolkit
- **HTTP 客戶端**：Axios
- **WebSocket**：Socket.io-client (用於即時數據更新)

#### 3.1.2 後端技術
- **主框架**：Python + FastAPI
- **即時通訊**：WebSocket
- **SSH 連接**：paramiko (Python)
- **數據庫**：
  - 時序數據：InfluxDB 或 TimescaleDB
  - 關係數據：PostgreSQL 或 MySQL
  - 快取：Redis
- **任務調度**：node-cron 或 Celery

#### 3.1.3 系統監控
- **Linux 指令**：top, htop, iostat, sar, free, df, netstat
- **系統文件**：/proc/stat, /proc/meminfo, /proc/net/dev
- **監控代理**：可選擇部署輕量級 agent 或純 SSH 方式

#### 3.1.4 部署與運維
- **容器化**：Docker + Docker Compose
- **反向代理**：Nginx
- **HTTPS**：Let's Encrypt 或自簽證書
- **監控**：Prometheus + Grafana (監控監控系統本身)

### 3.2 系統架構設計

#### 3.2.1 整體架構
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Web Browser   │    │   Load Balancer │    │   Target Linux  │
│                 │    │     (Nginx)     │    │    Servers      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         │ HTTPS/WSS            │ HTTP/WS              │ SSH
         │                       │                       │
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   Backend API   │    │   Data Collector│
│   (Vue/React)   │◄──►│   (Node.js/     │◄──►│   (SSH Client)  │
│                 │    │    Python)      │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                │
                                │
                       ┌─────────────────┐
                       │   Database      │
                       │   (InfluxDB +   │
                       │    PostgreSQL)  │
                       └─────────────────┘
```

#### 3.2.2 數據流設計
1. **數據收集**：後端定期透過 SSH 執行系統指令收集數據
2. **數據處理**：解析指令輸出，標準化數據格式
3. **數據存儲**：時序數據存入 InfluxDB，配置數據存入 PostgreSQL
4. **即時推送**：透過 WebSocket 將最新數據推送到前端
5. **歷史查詢**：前端請求歷史數據時從數據庫查詢

### 3.3 非功能性需求

#### 3.3.1 性能需求
- **響應時間**：頁面載入時間 < 3秒，數據更新延遲 < 5秒
- **並發支援**：支援至少 100 個並發用戶
- **伺服器數量**：單實例支援監控至少 50 台伺服器
- **數據更新頻率**：預設每 30 秒更新一次，可配置 10-300 秒

#### 3.3.2 可靠性需求
- **系統可用性**：99.5% 以上
- **故障恢復**：服務重啟後自動恢復監控
- **數據完整性**：確保監控數據不丟失
- **連接重試**：SSH 連接斷開後自動重試

#### 3.3.3 安全性需求
- **數據傳輸**：所有數據傳輸使用 HTTPS/WSS 加密
- **憑證存儲**：SSH 憑證使用 AES 加密存儲
- **訪問控制**：基於角色的訪問控制 (RBAC)
- **審計日誌**：記錄所有用戶操作和系統事件

#### 3.3.4 可擴展性需求
- **水平擴展**：支援多實例部署和負載均衡
- **插件架構**：支援自定義監控指標和通知方式
- **API 開放**：提供 RESTful API 供第三方集成
- **多租戶**：支援多組織隔離使用

## 4. 使用者體驗設計

### 4.1 UI/UX 設計原則

#### 4.1.1 視覺設計
- **暗色主題**：減少長時間監控的眼部疲勞
- **色彩系統**：
  - 主色調：藍色 (#0ea5e9) - 科技感和專業性
  - 成功色：綠色 (#10b981) - 正常狀態
  - 警告色：黃色 (#f59e0b) - 注意狀態
  - 危險色：紅色 (#ef4444) - 異常狀態
- **字體系統**：Inter 字體，確保數字清晰易讀
- **間距系統**：使用 Tailwind CSS 的間距規範

#### 4.1.2 資訊架構
- **三層結構**：
  1. 頂層：伺服器列表和全局操作
  2. 中層：選中伺服器的概覽指標
  3. 底層：詳細圖表和系統資訊
- **左側導航**：伺服器列表，支援搜尋和狀態篩選
- **主要內容區**：指標卡片 + 圖表 + 詳細資訊

#### 4.1.3 互動設計
- **即時反饋**：所有操作提供即時視覺反饋
- **狀態指示**：清晰的連接狀態和數據更新狀態
- **快捷操作**：常用功能提供快捷鍵支援
- **響應式設計**：適配桌面、平板、手機等不同設備

### 4.2 關鍵互動流程

#### 4.2.1 首次使用流程
1. **歡迎頁面**：簡要介紹產品功能和使用方法
2. **添加伺服器**：引導用戶添加第一台伺服器
3. **連接測試**：驗證連接並顯示基本資訊
4. **儀表板展示**：展示監控數據和功能介紹

#### 4.2.2 日常監控流程
1. **快速概覽**：登入後立即看到所有伺服器狀態
2. **伺服器選擇**：點擊左側列表切換監控目標
3. **深度分析**：查看詳細圖表和歷史趨勢
4. **問題處理**：發現異常時的快速響應流程

#### 4.2.3 警報處理流程
1. **警報通知**：即時彈窗或聲音提醒
2. **問題定位**：快速跳轉到異常伺服器
3. **詳細分析**：查看相關指標和歷史數據
4. **處理記錄**：記錄處理過程和結果

### 4.3 可用性設計

#### 4.3.1 易用性
- **零學習成本**：直觀的圖表和指標展示
- **智能預設**：合理的預設配置和閾值
- **操作引導**：關鍵功能提供操作提示
- **錯誤處理**：友好的錯誤訊息和解決建議

#### 4.3.2 可訪問性
- **鍵盤導航**：支援完整的鍵盤操作
- **色彩對比**：確保足夠的色彩對比度
- **字體大小**：支援字體大小調整
- **螢幕閱讀器**：支援輔助技術

## 5. 邊界條件與限制

### 5.1 技術限制

#### 5.1.1 系統相容性
- **支援的 Linux 發行版**：
  - Ubuntu 18.04+
  - CentOS/RHEL 7+
  - Debian 9+
  - SUSE Linux Enterprise 12+
- **不支援的系統**：Windows、macOS、嵌入式系統
- **網路需求**：目標伺服器必須開放 SSH 端口 (預設 22)

#### 5.1.2 性能限制
- **單實例限制**：建議監控伺服器數量不超過 100 台
- **數據保存期限**：預設保存 30 天詳細數據，1 年彙總數據
- **更新頻率限制**：最高每 10 秒更新一次 (避免對目標系統造成負載)
- **並發連接限制**：每台目標伺服器同時最多 3 個 SSH 連接

#### 5.1.3 安全限制
- **SSH 金鑰認證**：建議使用金鑰認證而非密碼認證
- **網路隔離**：監控系統應部署在安全的網路環境中
- **權限要求**：目標伺服器上的監控用戶需要適當的系統讀取權限
- **資料加密**：敏感數據必須加密存儲和傳輸

### 5.2 商業模式限制

#### 5.2.1 開源版本限制
- **伺服器數量**：最多監控 10 台伺服器
- **數據保存**：最多保存 7 天歷史數據
- **用戶數量**：最多 3 個並發用戶
- **技術支援**：僅提供社群支援

#### 5.2.2 商業版本功能
- **無限伺服器**：支援監控無限數量伺服器
- **長期數據存儲**：支援自定義數據保存期限
- **高級警報**：支援複雜的警報規則和通知方式
- **企業級支援**：提供 7x24 技術支援和 SLA 保證

#### 5.2.3 部署限制
- **硬體需求**：
  - 最低：2 CPU 核心，4GB RAM，20GB 存儲
  - 推薦：4 CPU 核心，8GB RAM，100GB SSD
- **網路需求**：穩定的網路連接，建議千兆網路
- **維護需求**：需要專業的系統管理員進行部署和維護

### 5.3 法規與合規限制

#### 5.3.1 數據隱私
- **GDPR 合規**：如果監控歐盟用戶的伺服器，需要符合 GDPR 要求
- **數據本地化**：某些地區可能要求數據不能跨境傳輸
- **用戶同意**：收集和處理監控數據需要獲得適當授權

#### 5.3.2 安全標準
- **ISO 27001**：企業客戶可能要求符合資訊安全管理標準
- **SOC 2**：雲端部署版本需要考慮 SOC 2 合規
- **行業標準**：金融、醫療等行業可能有特殊的合規要求

---

## 總結

CWatcher 是一個專注於 Linux 系統監控的 Web 平台，旨在為系統管理員和 DevOps 團隊提供直觀、高效的多伺服器監控解決方案。通過現代化的 Web 技術和用戶友好的介面設計，CWatcher 將複雜的系統監控工作簡化為直觀的視覺化體驗。

本 PRD 文檔為 CWatcher 的開發提供了全面的指導，涵蓋了從核心功能到技術實現的各個方面。建議按照優先級分階段實施，先完成 MVP 核心功能，再逐步增加高級特性，最終打造一個功能完整、性能優異的企業級監控平台。